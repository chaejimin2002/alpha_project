# Alpha Project - Alpaca ìë™ë§¤ë§¤ ë´‡

Alpaca APIë¥¼ í™œìš©í•œ SMA(Simple Moving Average) ì „ëµ ê¸°ë°˜ ìë™ë§¤ë§¤ ë´‡ì…ë‹ˆë‹¤.

## ğŸ—ï¸ ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Data Feed     â”‚â”€â”€â”€â–¶â”‚   Strategy      â”‚â”€â”€â”€â–¶â”‚   Risk Mgmt     â”‚
â”‚   (Alpaca API)  â”‚    â”‚   (SMA Signals) â”‚    â”‚   (TP/SL/Guard) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Main Bot Loop                                â”‚
â”‚              (bot.py - í•µì‹¬ ì‹¤í–‰ ì—”ì§„)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Broker        â”‚
â”‚   (Order Exec)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ì›Œí¬í”Œë¡œìš°

### 1. ì´ˆê¸°í™” ë‹¨ê³„
- í™˜ê²½ë³€ìˆ˜ ë¡œë“œ (`.env` íŒŒì¼)
- Alpaca API ì—°ê²° ì„¤ì •
- ë¡œê¹… ì„¤ì •
- ì‹œì¥ ìƒíƒœ í™•ì¸

### 2. ë©”ì¸ ë£¨í”„ (bot.py)
```python
while RUN:
    # 1. ì‹œì¥ ì‹œê°„ ì²´í¬
    # 2. ë°ì´í„° ìˆ˜ì§‘ (OHLCV)
    # 3. ì‹ í˜¸ ê³„ì‚° (SMA í¬ë¡œìŠ¤ì˜¤ë²„)
    # 4. ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì²´í¬
    # 5. í¬ì§€ì…˜ ê´€ë¦¬
    # 6. ì£¼ë¬¸ ì‹¤í–‰
    # 7. ëŒ€ê¸° (poll_sec)
```

### 3. ë°ì´í„° ìˆ˜ì§‘ (datafeed.py)
- Alpaca APIì—ì„œ ì‹¤ì‹œê°„ ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘
- OHLCV ë°ì´í„°ë¥¼ pandas DataFrameìœ¼ë¡œ ë³€í™˜
- ì„¤ì •ëœ ì‹œê°„í”„ë ˆì„ì— ë”°ë¥¸ ìº”ë“¤ ë°ì´í„°

### 4. ì „ëµ ì‹ í˜¸ ìƒì„± (strategy.py)
- **SMA í¬ë¡œìŠ¤ì˜¤ë²„ ì „ëµ**:
  - Fast SMA > Slow SMA â†’ ë§¤ìˆ˜ ì‹ í˜¸ (+1)
  - Fast SMA < Slow SMA â†’ ë§¤ë„ ì‹ í˜¸ (-1)
- ê³¨ë“  í¬ë¡œìŠ¤/ë°ë“œ í¬ë¡œìŠ¤ íŒ¨í„´ ê°ì§€

### 5. ë¦¬ìŠ¤í¬ ê´€ë¦¬ (risk.py)
- **í¬ì§€ì…˜ ì œí•œ**: ìµœëŒ€ í¬ì§€ì…˜ ìˆ˜ ì œí•œ
- **Take Profit/Stop Loss**: ì„¤ì •ëœ ìˆ˜ìµë¥ /ì†ì‹¤ë¥ ì—ì„œ ìë™ ì²­ì‚°
- **ì¼ì¼ ì†ì‹¤ ê°€ë“œ**: ì¼ì¼ ìµœëŒ€ ì†ì‹¤ í•œë„ ë„ë‹¬ ì‹œ ëª¨ë“  í¬ì§€ì…˜ ì²­ì‚°

### 6. ì£¼ë¬¸ ì‹¤í–‰ (broker.py)
- Alpaca Trading APIë¥¼ í†µí•œ ì‹¤ì œ ì£¼ë¬¸
- ì‹œì¥ê°€ ì£¼ë¬¸ (Market Order)
- í¬ì§€ì…˜ ì²­ì‚° ê¸°ëŠ¥
- ê³„ì¢Œ ì •ë³´ ì¡°íšŒ

## ğŸš¨ ì•ˆì „ì¥ì¹˜

1. **ì‹œì¥ ì‹œê°„ ì²´í¬**: ì¥ì™¸ ì‹œê°„ ê±°ë˜ ë°©ì§€
2. **ì¤‘ë³µ ë§¤ë§¤ ë°©ì§€**: ê°™ì€ ìº”ë“¤ ë‚´ ì¤‘ë³µ ì‹ í˜¸ ë¬´ì‹œ
3. **ì¼ì¼ ì†ì‹¤ ê°€ë“œ**: ì¼ì¼ ìµœëŒ€ ì†ì‹¤ í•œë„
4. **í¬ì§€ì…˜ ì œí•œ**: ë™ì‹œ ë³´ìœ  í¬ì§€ì…˜ ìˆ˜ ì œí•œ
5. **TP/SL**: ìë™ ì†ìµ ì‹¤í˜„

## ğŸ“Š ë°±í…ŒìŠ¤íŒ… (backtest.py)
- ê³¼ê±° ë°ì´í„°ë¡œ ì „ëµ ì„±ëŠ¥ ê²€ì¦
- ìˆ˜ìˆ˜ë£Œë¥¼ ê³ ë ¤í•œ PnL ê³„ì‚°
- ì´ˆê¸° ìë³¸ 10,000ë‹¬ëŸ¬ ê¸°ì¤€ ìˆ˜ìµë¥  ê³„ì‚°

## ğŸ”§ ì£¼ìš” ì„¤ì • (config.py)
- **ê±°ë˜ ì‹¬ë³¼**: ê¸°ë³¸ BTC/USDT
- **ì‹œê°„í”„ë ˆì„**: 1ë¶„ë´‰
- **ì£¼ë¬¸ í¬ê¸°**: 50ë‹¬ëŸ¬
- **ìµœëŒ€ í¬ì§€ì…˜**: 1ê°œ
- **ìˆ˜ìˆ˜ë£Œ**: 10bps
- **ìŠ¬ë¦¬í”¼ì§€**: 5bps

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ë¡œì»¬ í…ŒìŠ¤íŠ¸
```bash
# 1) ì½”ë“œ ë°›ê¸°
git clone <your repo> && cd alpaca-autotrader

# 2) ê°€ìƒ í™˜ê²½ ìƒì„± (python version 3.12)
~/.pyenv/versions/3.12.6/bin/python3 -m venv .alpha

# 3) ê°€ìƒ í™˜ê²½ í™œì„±í™”
source .alpha/bin/activate  

# 4) ì˜ì¡´ì„± ê´€ë¦¬
poetry lock  
poetry install --no-root 
poetry add ~~

# 5) ì‹¤í–‰
poetry run python app/bot.py

# 6) ê°€ìƒí™˜ê²½ ë¹„í™œì„±í™”
deactivate
```

### Docker ìƒì‹œ ì‹¤í–‰ (Poetry ê¸°ë°˜)
```bash
# 7) Dockerë¡œ ìƒì‹œ ì‹¤í–‰
docker compose up -d
docker compose logs -f trader
```

### Poetry ëª…ë ¹ì–´ ì°¸ê³ 
```bash
# ê°€ìƒí™˜ê²½ í™œì„±í™”
poetry shell

# ì˜ì¡´ì„± ì¶”ê°€
poetry add <package-name>

# ì˜ì¡´ì„± ì—…ë°ì´íŠ¸
poetry update

# ê°€ìƒí™˜ê²½ ì •ë³´ í™•ì¸
poetry env info

# ì˜ì¡´ì„± ë™ê¸°í™”
poetry install --sync
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
app/
â”œâ”€â”€ bot.py          # ë©”ì¸ ì‹¤í–‰ ì—”ì§„
â”œâ”€â”€ broker.py       # Alpaca API ë¸Œë¡œì»¤ ì¸í„°í˜ì´ìŠ¤
â”œâ”€â”€ strategy.py     # SMA ì „ëµ êµ¬í˜„
â”œâ”€â”€ datafeed.py     # ë°ì´í„° ìˆ˜ì§‘ ë° ë³€í™˜
â”œâ”€â”€ risk.py         # ë¦¬ìŠ¤í¬ ê´€ë¦¬ ëª¨ë“ˆ
â”œâ”€â”€ config.py       # ì„¤ì • ê´€ë¦¬
â””â”€â”€ backtest.py     # ë°±í…ŒìŠ¤íŒ… ëª¨ë“ˆ
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

- **Paper Trading ê¶Œì¥**: ì‹¤ì œ ìê¸ˆìœ¼ë¡œ ê±°ë˜í•˜ê¸° ì „ì— Paper Tradingìœ¼ë¡œ ì¶©ë¶„íˆ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”
- **API í‚¤ ë³´ì•ˆ**: `.env` íŒŒì¼ì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ê³  Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”
- **ë¦¬ìŠ¤í¬ ê´€ë¦¬**: ìë™ë§¤ë§¤ëŠ” ì†ì‹¤ ìœ„í—˜ì´ ìˆìœ¼ë¯€ë¡œ ì ì ˆí•œ ë¦¬ìŠ¤í¬ ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤
- **ì‹œì¥ ìƒí™©**: ê¸‰ê²©í•œ ì‹œì¥ ë³€ë™ ì‹œ ë´‡ì˜ ë™ì‘ì„ ëª¨ë‹ˆí„°ë§í•˜ì„¸ìš”